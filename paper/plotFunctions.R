#####Figure 1a#####

#The estimated value of π₀ is:         0.371051

#λ values to calculate this were:      [0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]

#with the corresponding π₀ values:     [1, 0.445501, 0.439427, 0.432638, 0.431452, 0.419355, 0.418433, 0.415881, 0.409677, 0.403519, 0.394194, 0.397133, 0.393548, 0.385253, 0.378495, 0.370323, 0.362903, 0.350538, 0.348387]

#and spline-smoothed π₀ values:        [0.847711, 0.646444, 0.507076, 0.419724, 0.374504, 0.361534, 0.370929, 0.392806, 0.417283, 0.434475, 0.436886, 0.426571, 0.40797, 0.385524, 0.363673, 0.34686, 0.339525, 0.346108, 0.371051]

###R code to produce diagnostic plots and qvalue package estimate of π₀

plot.data <- data.frame(lambda = c(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9),
                        pi0 = c(1, 0.445501, 0.439427, 0.432638, 0.431452, 0.419355, 0.418433, 0.415881, 0.409677, 0.403519, 0.394194, 0.397133, 0.393548, 0.385253, 0.378495, 0.370323, 0.362903, 0.350538, 0.348387),
                        pi0Est = c(0.847711, 0.646444, 0.507076, 0.419724, 0.374504, 0.361534, 0.370929, 0.392806, 0.417283, 0.434475, 0.436886, 0.426571, 0.40797, 0.385524, 0.363673, 0.34686, 0.339525, 0.346108, 0.371051))

qvalEst = smooth.spline(plot.data$lambda, plot.data$pi0, df = 3)$y ## replace 3 if different degrees of freedom is required

print(paste(c("Estimate of pi0 from qvalue package is:", qvalEst[length(qvalEst)]), collapse = ' '))

### Code to draw diagnostic plots with ggplot2

library(ggplot2)
plot1 <- ggplot(data = plot.data, aes(x = lambda, y = pi0)) + geom_point() +
                                                              geom_line(aes(x = lambda, y = pi0Est)) +
                                                              geom_abline(slope = 0, intercept = plot.data$pi0Est[nrow(plot.data)], col = 'red') +
                                                              labs(x = expression(lambda), y = expression(pi[0])) +
                                                              theme(axis.title = element_text(size = rel(2))) +
                                                              ylim(0, 1)
pdf("simple_diagnostic.pdf")
print(plot1)
dev.off()

#####Figure 1b#####

#The estimated value of π₀ is:            0.350538

#λ values to calculate this were:         [0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]

#with the corresponding π₀ values:        [1, 0.445501, 0.439427, 0.432638, 0.431452, 0.419355, 0.418433, 0.415881, 0.409677, 0.403519, 0.394194, 0.397133, 0.393548, 0.385253, 0.378495, 0.370323, 0.362903, 0.350538, 0.348387]

#and mean squared error estimates:        [42.4599, 0.964491, 0.85278, 0.738637, 0.719512, 0.538467, 0.518636, 0.497835, 0.423078, 0.340746, 0.252589, 0.28942, 0.257659, 0.182415, 0.136385, 0.0955588, 0.0851119, 0.0762539, 0.102196]

###R code to produce diagnostic plots for bootstrap estimates of π₀

plot.pi0.data <- data.frame(x = rep(c(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9), 100),
                            y = c(1, 0.444482, 0.430108, 0.423909, 0.419355, 0.408602, 0.404608, 0.4, 0.39086, 0.375953, 0.377419, 0.379928, 0.375, 0.373272, 0.365591, 0.371613, 0.354839, 0.350538, 0.351613, 1, 0.443124, 0.437993, 0.431879, 0.426613, 0.414194, 0.414286, 0.409926, 0.404839, 0.4, 0.392903, 0.404301, 0.391935, 0.382488, 0.367742, 0.356129, 0.340323, 0.326882, 0.312903, 1, 0.44618, 0.44086, 0.433017, 0.427823, 0.412903, 0.414286, 0.412407, 0.418817, 0.408211, 0.412903, 0.421505, 0.414516, 0.397235, 0.392473, 0.384516, 0.377419, 0.363441, 0.364516, 1, 0.443124, 0.437634, 0.43074, 0.431855, 0.418495, 0.409677, 0.402978, 0.395161, 0.385924, 0.375484, 0.380645, 0.374194, 0.370507, 0.35914, 0.343226, 0.335484, 0.311828, 0.283871, 1, 0.444482, 0.441935, 0.436053, 0.434274, 0.422796, 0.423041, 0.427295, 0.424194, 0.404106, 0.397419, 0.403584, 0.389516, 0.385253, 0.373118, 0.372903, 0.354839, 0.356989, 0.341935, 1, 0.427165, 0.421147, 0.411006, 0.412903, 0.40043, 0.393548, 0.394541, 0.395161, 0.392375, 0.387097, 0.38853, 0.391935, 0.391705, 0.390323, 0.378065, 0.391935, 0.389247, 0.409677, 1, 0.442445, 0.435484, 0.433017, 0.427419, 0.415914, 0.415668, 0.4134, 0.406452, 0.408798, 0.394194, 0.394982, 0.400806, 0.392627, 0.384946, 0.357419, 0.351613, 0.352688, 0.325806, 1, 0.449915, 0.442652, 0.429602, 0.422984, 0.40086, 0.402304, 0.405459, 0.398387, 0.402346, 0.401935, 0.41147, 0.409677, 0.402765, 0.378495, 0.372903, 0.369355, 0.365591, 0.36129, 1, 0.4309, 0.425806, 0.419734, 0.425403, 0.418925, 0.417512, 0.416873, 0.400538, 0.390616, 0.384516, 0.380645, 0.378226, 0.373272, 0.375269, 0.36, 0.332258, 0.313978, 0.293548, 1, 0.463497, 0.452688, 0.450474, 0.45, 0.446452, 0.441014, 0.437717, 0.429032, 0.424633, 0.407742, 0.412903, 0.410484, 0.389862, 0.373118, 0.347097, 0.322581, 0.296774, 0.325806, 1, 0.45399, 0.454839, 0.450854, 0.447581, 0.433978, 0.432719, 0.439206, 0.428495, 0.42346, 0.416774, 0.420072, 0.412097, 0.400922, 0.407527, 0.403871, 0.406452, 0.391398, 0.4, 1, 0.455348, 0.450538, 0.445161, 0.448387, 0.429247, 0.434562, 0.439702, 0.434946, 0.415836, 0.412258, 0.420789, 0.404839, 0.390783, 0.394624, 0.392258, 0.398387, 0.404301, 0.393548, 1, 0.455008, 0.450179, 0.442125, 0.440726, 0.425376, 0.425346, 0.422829, 0.40914, 0.402346, 0.39871, 0.403584, 0.404839, 0.398157, 0.406452, 0.4, 0.401613, 0.389247, 0.354839, 1, 0.458065, 0.451613, 0.440228, 0.440323, 0.428387, 0.435945, 0.442184, 0.444624, 0.43871, 0.424516, 0.41147, 0.401613, 0.389862, 0.382796, 0.380645, 0.374194, 0.393548, 0.358065, 1, 0.453311, 0.451254, 0.437951, 0.439516, 0.430968, 0.423041, 0.421836, 0.416667, 0.397067, 0.392258, 0.389964, 0.38871, 0.38341, 0.363441, 0.353548, 0.348387, 0.354839, 0.354839, 1, 0.44618, 0.441577, 0.433397, 0.430645, 0.423226, 0.423963, 0.417866, 0.415054, 0.411144, 0.404516, 0.409319, 0.398387, 0.389862, 0.384946, 0.381935, 0.367742, 0.348387, 0.364516, 1, 0.446859, 0.439427, 0.439089, 0.4375, 0.427097, 0.426267, 0.424318, 0.415591, 0.415836, 0.409032, 0.415771, 0.408871, 0.41106, 0.412903, 0.40129, 0.408065, 0.408602, 0.429032, 1, 0.451273, 0.451613, 0.447818, 0.443952, 0.428817, 0.423963, 0.417866, 0.411828, 0.400587, 0.381935, 0.387097, 0.383065, 0.371429, 0.352688, 0.335484, 0.322581, 0.316129, 0.303226, 1, 0.434295, 0.431183, 0.425427, 0.420565, 0.411613, 0.407373, 0.404467, 0.401613, 0.40176, 0.401935, 0.412186, 0.418548, 0.413825, 0.4, 0.385806, 0.380645, 0.408602, 0.416129, 1, 0.441087, 0.430824, 0.423529, 0.418952, 0.405591, 0.409217, 0.404467, 0.396774, 0.382405, 0.377419, 0.384946, 0.371774, 0.369585, 0.346237, 0.366452, 0.354839, 0.339785, 0.341935, 1, 0.459083, 0.451971, 0.451233, 0.456855, 0.442151, 0.439171, 0.436725, 0.437097, 0.426979, 0.416774, 0.421505, 0.417742, 0.401843, 0.396774, 0.384516, 0.380645, 0.352688, 0.341935, 1, 0.43837, 0.425448, 0.413662, 0.41371, 0.402581, 0.393088, 0.390571, 0.37957, 0.368328, 0.365806, 0.372043, 0.370968, 0.364977, 0.360215, 0.354839, 0.353226, 0.341935, 0.341935, 1, 0.448217, 0.441219, 0.43833, 0.434274, 0.425806, 0.423041, 0.420844, 0.409677, 0.39824, 0.392903, 0.390681, 0.381452, 0.374194, 0.368817, 0.36, 0.358065, 0.344086, 0.36129, 1, 0.439728, 0.432975, 0.426186, 0.419355, 0.406022, 0.402765, 0.407444, 0.402688, 0.390616, 0.387097, 0.395699, 0.390323, 0.376959, 0.369892, 0.348387, 0.31129, 0.298925, 0.296774, 1, 0.460441, 0.45448, 0.44592, 0.447177, 0.433978, 0.441475, 0.440199, 0.430108, 0.418182, 0.409032, 0.415771, 0.410484, 0.400922, 0.396774, 0.388387, 0.383871, 0.354839, 0.377419, 1, 0.455008, 0.453047, 0.449336, 0.446371, 0.437419, 0.432258, 0.433251, 0.432796, 0.42522, 0.412903, 0.415054, 0.415323, 0.410138, 0.408602, 0.405161, 0.382258, 0.376344, 0.396774, 1, 0.449915, 0.439427, 0.435674, 0.431855, 0.415054, 0.418894, 0.415881, 0.404839, 0.395894, 0.392903, 0.397849, 0.404032, 0.381567, 0.362366, 0.331613, 0.303226, 0.298925, 0.290323, 1, 0.437012, 0.432975, 0.426186, 0.431452, 0.421935, 0.419355, 0.41737, 0.412903, 0.407625, 0.394194, 0.394265, 0.395161, 0.39447, 0.387097, 0.381935, 0.375806, 0.389247, 0.380645, 1, 0.462139, 0.460215, 0.452751, 0.453226, 0.44086, 0.439631, 0.430273, 0.424731, 0.426393, 0.408387, 0.415771, 0.41371, 0.415668, 0.403226, 0.4, 0.387097, 0.384946, 0.393548, 1, 0.449576, 0.440143, 0.43871, 0.431048, 0.413333, 0.413364, 0.415385, 0.40914, 0.390616, 0.389032, 0.382079, 0.385484, 0.371429, 0.366667, 0.36, 0.35, 0.346237, 0.358065, 1, 0.449915, 0.443728, 0.439469, 0.441129, 0.432258, 0.430415, 0.424814, 0.419892, 0.414076, 0.412258, 0.417921, 0.403226, 0.393548, 0.388172, 0.380645, 0.383871, 0.376344, 0.364516, 1, 0.443803, 0.43871, 0.434535, 0.441532, 0.425806, 0.429493, 0.426799, 0.426882, 0.418768, 0.407742, 0.405735, 0.408871, 0.393548, 0.386022, 0.380645, 0.362903, 0.329032, 0.335484, 1, 0.436333, 0.430108, 0.422391, 0.420565, 0.413333, 0.415668, 0.405955, 0.398925, 0.395308, 0.385806, 0.376344, 0.382258, 0.375115, 0.368817, 0.357419, 0.333871, 0.329032, 0.335484, 1, 0.442105, 0.436201, 0.431499, 0.434677, 0.413333, 0.415668, 0.414888, 0.418817, 0.425806, 0.419355, 0.426523, 0.421774, 0.420276, 0.413978, 0.4, 0.38871, 0.352688, 0.316129, 1, 0.445501, 0.440143, 0.431879, 0.430242, 0.416774, 0.418433, 0.419355, 0.415054, 0.405865, 0.398065, 0.390681, 0.385484, 0.370507, 0.368817, 0.370323, 0.354839, 0.335484, 0.345161, 1, 0.447538, 0.444086, 0.433397, 0.429839, 0.416774, 0.410138, 0.409429, 0.403226, 0.391789, 0.389032, 0.393548, 0.381452, 0.373272, 0.374194, 0.370323, 0.362903, 0.363441, 0.36129, 1, 0.441087, 0.431541, 0.424668, 0.421371, 0.408172, 0.402765, 0.410422, 0.403763, 0.397654, 0.392903, 0.389964, 0.391935, 0.37235, 0.364516, 0.366452, 0.375806, 0.369892, 0.364516, 1, 0.451952, 0.441935, 0.434535, 0.433871, 0.427097, 0.420737, 0.415385, 0.413441, 0.402346, 0.396774, 0.397849, 0.401613, 0.386175, 0.36129, 0.363871, 0.343548, 0.31828, 0.341935, 1, 0.442445, 0.437634, 0.433397, 0.436694, 0.427097, 0.431336, 0.433747, 0.422581, 0.415836, 0.407097, 0.402151, 0.393548, 0.381567, 0.35914, 0.332903, 0.341935, 0.333333, 0.306452, 1, 0.439389, 0.431183, 0.418975, 0.422177, 0.409032, 0.408756, 0.406452, 0.396774, 0.387683, 0.385806, 0.387097, 0.385484, 0.380645, 0.358065, 0.347097, 0.366129, 0.335484, 0.303226, 1, 0.439728, 0.436918, 0.434535, 0.429032, 0.419785, 0.419355, 0.417866, 0.421505, 0.41173, 0.410968, 0.41362, 0.406452, 0.391705, 0.389247, 0.383226, 0.372581, 0.348387, 0.316129, 1, 0.470968, 0.460215, 0.445161, 0.439516, 0.427527, 0.427189, 0.419851, 0.415054, 0.41349, 0.410968, 0.409319, 0.41371, 0.419355, 0.406452, 0.40129, 0.369355, 0.365591, 0.345161, 1, 0.457385, 0.452688, 0.4463, 0.445161, 0.430968, 0.432719, 0.427792, 0.423656, 0.416422, 0.404516, 0.415054, 0.408871, 0.396313, 0.392473, 0.380645, 0.343548, 0.331183, 0.309677, 1, 0.442784, 0.436918, 0.434535, 0.426613, 0.415914, 0.409677, 0.405459, 0.406989, 0.402346, 0.392903, 0.38638, 0.385484, 0.37788, 0.367742, 0.372903, 0.375806, 0.335484, 0.309677, 1, 0.452971, 0.445161, 0.43871, 0.43871, 0.432258, 0.439171, 0.437221, 0.430108, 0.424633, 0.421935, 0.420789, 0.418548, 0.403687, 0.4, 0.402581, 0.387097, 0.395699, 0.4, 1, 0.44652, 0.441935, 0.436433, 0.427419, 0.413763, 0.412903, 0.414392, 0.409677, 0.408211, 0.398065, 0.402151, 0.390323, 0.379724, 0.374194, 0.366452, 0.377419, 0.356989, 0.354839, 1, 0.441426, 0.441219, 0.435294, 0.439113, 0.435699, 0.432258, 0.430273, 0.427957, 0.420528, 0.407742, 0.402151, 0.401613, 0.382488, 0.377419, 0.36129, 0.372581, 0.346237, 0.33871, 1, 0.454669, 0.452688, 0.443264, 0.436694, 0.426667, 0.420737, 0.415881, 0.406989, 0.403519, 0.389677, 0.389964, 0.391129, 0.387097, 0.390323, 0.366452, 0.370968, 0.35914, 0.33871, 1, 0.436333, 0.429032, 0.426945, 0.422177, 0.409032, 0.407834, 0.401985, 0.398925, 0.38651, 0.38, 0.387097, 0.383871, 0.364055, 0.351613, 0.338065, 0.314516, 0.292473, 0.274194, 1, 0.436672, 0.429749, 0.424288, 0.419355, 0.409462, 0.409217, 0.407444, 0.400538, 0.389443, 0.377419, 0.379211, 0.378226, 0.363134, 0.349462, 0.334194, 0.354839, 0.350538, 0.332258, 1, 0.45399, 0.449462, 0.447438, 0.448387, 0.436559, 0.43871, 0.439206, 0.429032, 0.426979, 0.42129, 0.422939, 0.412903, 0.406452, 0.401075, 0.390968, 0.383871, 0.337634, 0.358065, 1, 0.448217, 0.434409, 0.426186, 0.425, 0.409462, 0.409217, 0.407444, 0.403226, 0.404106, 0.400645, 0.415771, 0.416129, 0.407373, 0.401075, 0.388387, 0.372581, 0.356989, 0.354839, 1, 0.432598, 0.430824, 0.428463, 0.426613, 0.413763, 0.412903, 0.4134, 0.408065, 0.39824, 0.384516, 0.396416, 0.392742, 0.388018, 0.392473, 0.384516, 0.382258, 0.36129, 0.367742, 1, 0.444143, 0.430108, 0.42277, 0.420968, 0.402151, 0.395853, 0.388089, 0.38871, 0.384751, 0.375484, 0.379211, 0.371774, 0.364977, 0.368817, 0.352258, 0.340323, 0.316129, 0.325806, 1, 0.456027, 0.449462, 0.444402, 0.442339, 0.428817, 0.428571, 0.42928, 0.426344, 0.409384, 0.406452, 0.420789, 0.426613, 0.41106, 0.380645, 0.387097, 0.370968, 0.346237, 0.316129, 1, 0.455348, 0.45233, 0.445161, 0.442742, 0.428817, 0.423502, 0.422333, 0.419355, 0.412903, 0.409032, 0.410753, 0.416129, 0.407373, 0.403226, 0.406452, 0.406452, 0.402151, 0.367742, 1, 0.448217, 0.443011, 0.437571, 0.440726, 0.427097, 0.42212, 0.415385, 0.404301, 0.397067, 0.394194, 0.405018, 0.406452, 0.399078, 0.392473, 0.384516, 0.395161, 0.374194, 0.358065, 1, 0.442105, 0.430108, 0.424288, 0.427419, 0.412043, 0.409677, 0.402481, 0.396237, 0.381818, 0.380645, 0.382796, 0.382258, 0.369585, 0.369892, 0.348387, 0.340323, 0.31828, 0.322581, 1, 0.437691, 0.436918, 0.427704, 0.427823, 0.416774, 0.415668, 0.416377, 0.413441, 0.400587, 0.387097, 0.38853, 0.395161, 0.391705, 0.387097, 0.374194, 0.367742, 0.363441, 0.348387, 1, 0.456367, 0.450538, 0.439848, 0.441532, 0.431398, 0.424885, 0.422333, 0.41129, 0.400587, 0.391613, 0.41147, 0.412097, 0.403687, 0.408602, 0.421935, 0.433871, 0.4, 0.374194, 1, 0.449915, 0.446237, 0.437571, 0.43871, 0.421935, 0.417512, 0.419851, 0.413978, 0.40176, 0.397419, 0.408602, 0.412903, 0.396313, 0.391398, 0.393548, 0.377419, 0.352688, 0.354839, 1, 0.445501, 0.441935, 0.433776, 0.431855, 0.417204, 0.415207, 0.416873, 0.411828, 0.40176, 0.388387, 0.383513, 0.372581, 0.36129, 0.360215, 0.343226, 0.333871, 0.322581, 0.322581, 1, 0.453311, 0.450179, 0.442884, 0.437097, 0.420215, 0.419816, 0.419355, 0.410215, 0.407038, 0.395484, 0.402151, 0.404839, 0.367742, 0.352688, 0.335484, 0.312903, 0.303226, 0.316129, 1, 0.44618, 0.438351, 0.429981, 0.428629, 0.412903, 0.408756, 0.404963, 0.391935, 0.384751, 0.375484, 0.369176, 0.366129, 0.362212, 0.356989, 0.343226, 0.354839, 0.333333, 0.306452, 1, 0.442784, 0.428315, 0.420873, 0.417339, 0.410753, 0.415207, 0.412407, 0.412366, 0.408798, 0.396129, 0.402867, 0.402419, 0.404608, 0.384946, 0.371613, 0.377419, 0.380645, 0.380645, 1, 0.455008, 0.445878, 0.439469, 0.434274, 0.433118, 0.431797, 0.433747, 0.43172, 0.429326, 0.410323, 0.416487, 0.405645, 0.389862, 0.392473, 0.362581, 0.367742, 0.36129, 0.351613, 1, 0.443124, 0.437993, 0.427704, 0.427016, 0.409892, 0.400461, 0.390571, 0.387097, 0.385337, 0.370968, 0.372043, 0.359677, 0.3447, 0.346237, 0.331613, 0.332258, 0.329032, 0.351613, 1, 0.442445, 0.437276, 0.434915, 0.4375, 0.428817, 0.428571, 0.423821, 0.416667, 0.408211, 0.409032, 0.407168, 0.400806, 0.387097, 0.395699, 0.389677, 0.390323, 0.352688, 0.332258, 1, 0.434635, 0.427599, 0.421632, 0.421371, 0.405161, 0.401382, 0.406452, 0.408065, 0.40176, 0.392258, 0.404301, 0.393548, 0.369585, 0.349462, 0.31871, 0.296774, 0.31828, 0.296774, 1, 0.434635, 0.431541, 0.428843, 0.431048, 0.418495, 0.415668, 0.418859, 0.415054, 0.410557, 0.4, 0.41362, 0.415323, 0.407373, 0.401075, 0.376774, 0.374194, 0.316129, 0.293548, 1, 0.448557, 0.440143, 0.437192, 0.436694, 0.427527, 0.420737, 0.420347, 0.41129, 0.408798, 0.394839, 0.400717, 0.400806, 0.386175, 0.380645, 0.369032, 0.358065, 0.333333, 0.358065, 1, 0.450594, 0.446237, 0.435674, 0.435887, 0.426237, 0.42765, 0.418362, 0.412366, 0.4, 0.394194, 0.392832, 0.383871, 0.385253, 0.367742, 0.374194, 0.379032, 0.356989, 0.348387, 1, 0.42309, 0.418638, 0.415939, 0.416129, 0.404301, 0.399539, 0.397519, 0.393011, 0.384164, 0.374194, 0.381362, 0.369355, 0.357604, 0.349462, 0.335484, 0.304839, 0.301075, 0.322581, 1, 0.450594, 0.440143, 0.424288, 0.423387, 0.409892, 0.412442, 0.409429, 0.413978, 0.402346, 0.389677, 0.385663, 0.381452, 0.375115, 0.370968, 0.36129, 0.33871, 0.324731, 0.335484, 1, 0.450594, 0.442294, 0.434535, 0.435484, 0.429247, 0.427189, 0.423325, 0.416667, 0.417595, 0.409032, 0.420789, 0.407258, 0.402765, 0.38172, 0.365161, 0.358065, 0.35914, 0.374194, 1, 0.437691, 0.437276, 0.430361, 0.434274, 0.423226, 0.423041, 0.418362, 0.421505, 0.416422, 0.412903, 0.412903, 0.401613, 0.40553, 0.397849, 0.381935, 0.374194, 0.36129, 0.370968, 1, 0.43056, 0.422581, 0.420873, 0.418145, 0.411183, 0.417512, 0.411911, 0.408602, 0.405279, 0.40129, 0.394982, 0.397581, 0.381567, 0.373118, 0.356129, 0.346774, 0.331183, 0.303226, 1, 0.453311, 0.451971, 0.449715, 0.447984, 0.43914, 0.43318, 0.434243, 0.427419, 0.417595, 0.400645, 0.410036, 0.400806, 0.39447, 0.389247, 0.374194, 0.367742, 0.339785, 0.329032, 1, 0.433616, 0.431183, 0.425047, 0.424597, 0.416344, 0.415668, 0.420844, 0.409677, 0.414663, 0.39871, 0.406452, 0.402419, 0.4, 0.401075, 0.394839, 0.396774, 0.365591, 0.33871, 1, 0.451952, 0.453405, 0.445541, 0.446371, 0.434409, 0.436866, 0.434739, 0.428495, 0.419355, 0.416774, 0.418638, 0.41371, 0.395392, 0.384946, 0.381935, 0.385484, 0.384946, 0.409677, 1, 0.447199, 0.441219, 0.437192, 0.439516, 0.430108, 0.43318, 0.430769, 0.419892, 0.408798, 0.396129, 0.391398, 0.394355, 0.396313, 0.388172, 0.376774, 0.358065, 0.346237, 0.358065, 1, 0.447538, 0.437634, 0.436053, 0.432258, 0.423226, 0.423502, 0.424318, 0.416129, 0.404106, 0.396774, 0.4, 0.405645, 0.406452, 0.390323, 0.374194, 0.374194, 0.36129, 0.358065, 1, 0.443124, 0.437634, 0.43112, 0.427823, 0.421075, 0.420737, 0.419355, 0.412903, 0.407038, 0.4, 0.400717, 0.401613, 0.386175, 0.37957, 0.369032, 0.367742, 0.339785, 0.332258, 1, 0.459762, 0.455197, 0.450474, 0.443145, 0.430108, 0.415207, 0.410918, 0.405376, 0.39824, 0.383226, 0.391398, 0.383871, 0.38341, 0.387097, 0.378065, 0.359677, 0.333333, 0.329032, 1, 0.445161, 0.44552, 0.4463, 0.444758, 0.434839, 0.430876, 0.433251, 0.421505, 0.422287, 0.404516, 0.407885, 0.408065, 0.399078, 0.387097, 0.380645, 0.367742, 0.372043, 0.341935, 1, 0.451952, 0.447312, 0.441746, 0.443548, 0.427527, 0.418894, 0.415881, 0.405376, 0.394135, 0.390968, 0.389964, 0.379839, 0.37788, 0.35914, 0.345806, 0.332258, 0.303226, 0.319355, 1, 0.44618, 0.439785, 0.43074, 0.428226, 0.414624, 0.41106, 0.410422, 0.401075, 0.402346, 0.396129, 0.397133, 0.398387, 0.38341, 0.374194, 0.35871, 0.335484, 0.301075, 0.341935, 1, 0.432937, 0.423656, 0.416698, 0.41129, 0.403871, 0.412442, 0.410918, 0.40914, 0.409384, 0.396129, 0.4, 0.391129, 0.388018, 0.389247, 0.370323, 0.370968, 0.365591, 0.358065, 1, 0.432937, 0.430108, 0.42277, 0.423387, 0.410323, 0.408756, 0.414392, 0.404839, 0.411144, 0.402581, 0.404301, 0.405645, 0.395392, 0.401075, 0.403871, 0.380645, 0.393548, 0.435484, 1, 0.448217, 0.440502, 0.430361, 0.431048, 0.423656, 0.424885, 0.418859, 0.422043, 0.416422, 0.410323, 0.421505, 0.423387, 0.415668, 0.416129, 0.402581, 0.396774, 0.372043, 0.358065, 1, 0.455008, 0.443369, 0.429602, 0.435081, 0.430108, 0.434562, 0.430273, 0.424731, 0.419355, 0.411613, 0.418638, 0.416935, 0.410138, 0.408602, 0.40129, 0.401613, 0.387097, 0.390323, 1, 0.448896, 0.445878, 0.435674, 0.432258, 0.419785, 0.424885, 0.418362, 0.413441, 0.395308, 0.383871, 0.378495, 0.374194, 0.380645, 0.374194, 0.356129, 0.343548, 0.350538, 0.367742, 1, 0.447538, 0.446237, 0.434535, 0.437097, 0.426237, 0.413364, 0.409429, 0.406452, 0.396481, 0.375484, 0.380645, 0.379032, 0.37235, 0.36129, 0.350968, 0.358065, 0.352688, 0.364516, 1, 0.451952, 0.441935, 0.436433, 0.429032, 0.420645, 0.416129, 0.416377, 0.41129, 0.400587, 0.389032, 0.380645, 0.382258, 0.378802, 0.35914, 0.36, 0.36129, 0.348387, 0.36129, 1, 0.449236, 0.441577, 0.434915, 0.435484, 0.430538, 0.42765, 0.427792, 0.408602, 0.396481, 0.374839, 0.385663, 0.391935, 0.390783, 0.380645, 0.381935, 0.369355, 0.356989, 0.332258, 1, 0.450594, 0.442294, 0.440607, 0.443952, 0.429677, 0.430415, 0.435236, 0.429032, 0.426393, 0.414194, 0.420072, 0.410484, 0.417512, 0.408602, 0.40129, 0.372581, 0.354839, 0.374194, 1, 0.448896, 0.443728, 0.43833, 0.43871, 0.426237, 0.422581, 0.424814, 0.415054, 0.417009, 0.40129, 0.4, 0.4, 0.389862, 0.384946, 0.370323, 0.345161, 0.329032, 0.335484, 1, 0.425806, 0.424014, 0.414801, 0.413306, 0.402581, 0.392627, 0.392556, 0.384946, 0.384164, 0.381935, 0.379211, 0.375, 0.371429, 0.367742, 0.352258, 0.329032, 0.31828, 0.309677, 1, 0.447199, 0.437634, 0.434535, 0.435887, 0.423226, 0.42212, 0.427295, 0.417204, 0.412317, 0.403226, 0.409319, 0.397581, 0.373272, 0.363441, 0.362581, 0.367742, 0.372043, 0.387097, 1, 0.439728, 0.435125, 0.426186, 0.423387, 0.413763, 0.42212, 0.420347, 0.414516, 0.399413, 0.39871, 0.401434, 0.403226, 0.393548, 0.392473, 0.385806, 0.375806, 0.356989, 0.341935))

plot.data <- data.frame(x = c(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9),
                        y = c(1, 0.445501, 0.439427, 0.432638, 0.431452, 0.419355, 0.418433, 0.415881, 0.409677, 0.403519, 0.394194, 0.397133, 0.393548, 0.385253, 0.378495, 0.370323, 0.362903, 0.350538, 0.348387),
                        mse = c(42.4599, 0.964491, 0.85278, 0.738637, 0.719512, 0.538467, 0.518636, 0.497835, 0.423078, 0.340746, 0.252589, 0.28942, 0.257659, 0.182415, 0.136385, 0.0955588, 0.0851119, 0.0762539, 0.102196),
                        minpi0 = 0.348387,
                        final = 0.350538)

library(ggplot2)
plot1 <- ggplot(plot.data, aes(x = x, y = y)) + geom_boxplot(data = plot.pi0.data, aes(x = x, y = y, group = x)) +
                                                geom_point(colour='blue') +
                                                geom_hline(yintercept = plot.data$minpi0, colour = 'blue') +
                                                geom_line(aes(x = x, y = mse), linetype = 'dashed') +
                                                geom_hline(yintercept = plot.data$final, colour = 'red') +
                                                geom_vline(xintercept = plot.data$x[plot.data$mse==min(plot.data$mse)], linetype = 'dashed') +
                                                ylim(0,1) +
                                                labs(x = expression(lambda), y = expression(pi[0])) +
                                                theme(axis.title = element_text(size = rel(2)))
pdf("boot_diagnostic.pdf")
print(plot1)
dev.off()


#####Figure 2#####

library(ggplot2)

results <- read.table(file="timings", header=T)
results <- cbind(results, paste(results[, 1], results[, 2], results[, 3], sep='_'))
results <- results[order(results[, 4]),]

plot.data <- results[!duplicated(results[, 6]),]
plot.data$Software <- gsub("L", "l", plot.data$Software)
plot.data$Type = factor(plot.data$Type, levels = c("Bootstrap", "Normal"), labels = c("Bootstrap", "Standard"))

pdf("Timings.pdf")
ggplot(plot.data, aes(y = CPU, x = PValues, col=Software)) + geom_line() +
          facet_wrap(~Type) +
          theme(strip.text = element_text(size=rel(1.5)), legend.text = element_text(size=rel(1.5)),
                legend.position = "top", legend.title = element_text(size=rel(1.5)),
                axis.title = element_text(size=rel(1.5))) +
          labs(y = "CPU time (seconds)", x = "Number of p values")
dev.off()

## rm(list=ls(all=T))
## results <- read.table(file="timings", header=T)
## results <- cbind(results, paste(results[, 1], results[, 2], results[, 3], sep='_'))
## results <- results[!is.na(results[, 5]), ]
## results <- results[order(results[, 5]), ]
## plot.data <- results[!duplicated(results[, 6]), ]

## plot.data <- plot.data[order(plot.data[,1]),]
## plot.data <- plot.data[order(plot.data[,3]),]
## plot.data <- plot.data[order(a[,2]),]

## pdf("mem_use.pdf")
## ggplot(data = data.frame(PValues = plot.data[1:8, 1], Memory = plot.data[9:16,5] / plot.data[1:4,5],
          ##                   Type = rep(c("Bootstrap", "Standard"), each = 4)),
          ## aes(x=PValues, y = Memory, col=Type)) +
          ## geom_line() +
          ## labs(x = "Number of p values", y = "Ratio of memory use") +
          ## theme(legend.position = "top", legend.text = element_text(size=rel(1.5)),
          ##       axis.title = element_text(size=rel(1.5)),
          ##       legend.title = element_text(size=rel(1.5)))
## dev.off()
